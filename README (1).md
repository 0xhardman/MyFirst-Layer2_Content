# 2.1 状态通道（原型机：状态通道）

假设 Alice 经常在一家咖啡店消费，如果每次买一杯5美元的咖啡，都需要支付 0.5 美元的手续费，这也太痛苦了。如果 Alice 和咖啡店能达成共识，Alice 在区块链上质押一笔较大的金额，每次买咖啡时付给咖啡店一张签了名的小票，几个月后咖啡店攒了足够多的小票，只用支付一次手续费就能将这些金额一次性兑现，这样交易成本就变得微乎其微了。这种思路就是最早的二层网络，也就是状态通道的原理。

状态通道使用了多签技术，允许两个个体之间提前存入一笔资金锁定在智能合约中，建立一个内部通道，然后双方可以在通道内进行多笔小额转账，速度极快，成本极低，再在一段时间后用转账证明一次性提款。状态通道也是比特币的“闪电网络”，以太坊的“雷电网络”背后的底层技术。

![【图：2.1.1 单通道闪电网络.gif】](https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F1e556aad-d303-4a00-9c75-e281e195fbdf%2FUntitled.png?id=c4904364-3f87-4651-9109-9044adc3b667\&table=block\&spaceId=b1dd17ad-aa83-4faf-9395-5329c519d830\&width=2000\&userId=e298088e-2c93-42ed-870b-b44d950d1eae\&cache=v2)

雷电网络节点越多，整个网络能处理交易的规模也将越大，并且用户能通过多个节点的中转，向更多人转账。

![【图：2.1.2 闪电网络.gif】](https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fa84415ef-393f-4864-8cda-ad1335778022%2FUntitled.png?id=19f1b366-e61a-4b10-a1c2-2226adace016\&table=block\&spaceId=b1dd17ad-aa83-4faf-9395-5329c519d830\&width=2000\&userId=e298088e-2c93-42ed-870b-b44d950d1eae\&cache=v2)

状态通道技术本质上是使用了**中心化的节点**，用户在链下用签了名的“小票”进行付款，积攒了一定量的小票之后，任何一方都可以选择关闭通道进行结算。链上的智能合约只认可同时拥有双方签名的转账信息，Alice 和咖啡店都拥有自己的签名，再加上小票上对方的签名才能**通过多签验证**，因此无法提取不属于自己的资金。

但这样做产生了 2 个新的问题：

1. 多签小票仅适合最简单的转账交易，去中心化金融要实现的交易比它们复杂得多，**想要实现更复杂的交易要怎么办呢**？为了解决这个问题，引出了**侧链**方案。
2. 状态通道仅支持建立通道的双方进行转账，或依靠多个彼此相连的通道进行中转，但是我们**如何给未参与闪电网络的个体发送资金呢**？这个问题，则引出了 **Plasma** 方案。
